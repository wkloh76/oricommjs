<script defer>
  /**
   * Copyright (c) 2024   Loh Wah Kiang
   *
   * openGauss is licensed under Mulan PSL v2.
   * You can use this software according to the terms and conditions of the Mulan PSL v2.
   * You may obtain a copy of Mulan PSL v2 at:
   *
   *          http://license.coscl.org.cn/MulanPSL2
   *
   * THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND,
   * EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT,
   * MERCHANTABILITY OR FIT FOR A PARTICULAR PURPOSE.
   * See the Mulan PSL v2 for more details.
   * -------------------------------------------------------------------------
   */
  "use strict";
  var glib = {};
  window.addEventListener("DOMContentLoaded", async () => {
    if (mjs) {
      if (mjs.external.length > 0) await loadlib(mjs.external);
      if (mjs.internal.length > 0) await loadlib(mjs.internal);
      if (Object.keys(mjs.initialize).length > 0) await initialize(mjs.initialize);
    }
  });

  const initialize = async (...args) => {
    let [param] = args;
    if (glib?.cbtoolbox) {
      for (let [idx, val] of param.methods.entries()) {
        let func = glib.cbtoolbox.getNestedObject(glib, val);
        if (func) await func.apply(null, param.argv[idx]);
      }
    }
    return;
  };

  const loadlib = async (...args) => {
    try {
      let [param] = args;
      if (param?.lists) {
        for (let item of param.lists) {
          let fn = item.split("/").pop();
          let { default: df } = await import(`${param.url}${item}`);
          glib[fn] = { ...df };
        }
      }
      return;
    } catch (error) {
      console.log(error);
    }
  };
</script>